var $orderSelectedProjectsCount = $('#order-selected-projects-count');
var $orderProgress = $('#order-progress');
var $projectItem = $('#project-<%= project.id %>-item');
var $budgetConfirm = $('#budget-confirm');
var $projectBudgetButton = $('#project-<%= project.id %>-budget-button');
var $projectModal = $('#project-modal-<%= project.id %>');

if ($orderProgress) {
  morphdom($orderProgress[0], '<%= j(render partial: "decidim/budgets/projects/order_progress").strip.html_safe %>');
}
morphdom($budgetConfirm[0], '<%= j(render partial: "decidim/budgets/projects/budget_confirm").strip.html_safe %>')
if ($orderSelectedProjectsCount.length > 0) {
  morphdom($orderSelectedProjectsCount[0], '<%= j(render partial: "decidim/budgets/projects/projects_count", locals: { count: current_order.projects.size }).strip.html_safe %>')
}

if ($projectItem.length > 0) {
  <% if params[:action] == "destroy" && params[:show_only_added] == "true" %>
    $projectItem[0].remove();
  <% else %>
    morphdom($projectItem[0], '<%= j(render partial: "decidim/budgets/projects/project", locals: { project: }).strip.html_safe %>');
  <% end %>
}

if ($projectModal.length > 0 && $projectModal.attr("aria-hidden") === "false") {
  $(".project-vote-button", $projectModal).focus();
} else {
  $(".project-vote-button", $projectItem).focus();
}

window.DecidimBudgets.checkProgressPosition();
