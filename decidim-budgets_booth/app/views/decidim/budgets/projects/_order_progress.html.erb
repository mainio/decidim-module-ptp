<div id="order-progress">
  <div class="budget-summary__progressbox flex gap-12" data-current-allocation="<%= current_order ? current_order.total : 0 %>" data-progress-reference>
    <div class="progress budget-progress bg-white w-5/6 h-10" role="progressbar" aria-valuenow="<%= current_order_budget_percent %>" aria-valuetext="<%= current_order_budget_percent %>%" aria-valuemin="0" aria-valuemax="100">
      <div class="progress-meter progress-meter--minimum" style="width: <%= current_order_budget_percent_minimum %>%"></div>
      <!--Change width and text dynamically.-->
      <div class="progress-meter budget-progress__meter bg-gray-3 h-full flex items-center justify-center" style="width: <%= current_order_budget_percent %>%">
        <span class="progress-meter-text progress-meter-text--right font-semibold <%= current_order_budget_percent < 20 ? 'ml-16' : '' %>"><%= current_order_budget_percent %>%</span>
      </div>
    </div>
    <% if !current_order_checked_out? && voting_open? %>
      <button class="button button__sm hollow button__secondary" data-toggle="budget-confirm" <%= budget_confirm_disabled_attr %>>
        <%= voting_booth_forced? ? t(".vote") : t(".ready") %>
      </button>
    <% end %>
  </div>

  <div class="progressbox-fixed-wrapper fixed top-0 left-0 right-0 z-50 bg-white shadow hidden is-progressbox-visible:block" data-progressbox-fixed>
    <div class="budget-summary__progressbox budget-summary__progressbox--fixed padding-bottom-0">
      <% if current_order.projects_rule? %>
        <span class="mini-title"><%= t(".total_projects") %>
          <strong class="mini-title__strong mini-title__strong--highlight">
            <%= render partial: "decidim/budgets/line_items/order_remaining_budget" %>
          </strong>
        </span>
      <% else %>
        <span class="mini-title"><%= t(".total_budget") %>
          <strong class="mini-title__strong mini-title__strong--highlight">
            <%= budget_to_currency(budget.total_budget) %>
          </strong>
        </span>
      <% end %>
    </div>
    <div class="budget-summary__progressbox budget-summary__progressbox--fixed">
      <div class="progress budget-progress budget-progress--fixed" role="progressbar" aria-valuenow="<%= current_order_budget_percent %>" aria-valuetext="<%= current_order_budget_percent %>%" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-meter progress-meter--minimum" style="width: <%= current_order_budget_percent_minimum %>%"></div>
        <div class="progress-meter budget-progress__meter" style="width: <%= current_order_budget_percent %>%">
          <span class="progress-meter-text progress-meter-text--right font-semibold <%= current_order_budget_percent < 20 ? 'ml-16' : '' %>"><%= current_order_budget_percent %>%</span>
        </div>
      </div>
      <% if !current_order_checked_out? && voting_open? %>
        <button class="button small button--sc" data-toggle="budget-confirm" <%= budget_confirm_disabled_attr %>>
          <%= t(".vote") %>
        </button>
      <% end %>
    </div>
  </div>
</div>
